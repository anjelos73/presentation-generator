<!DOCTYPE html><html lang="it"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Presentation Generator - PowerPoint & PDF from Text</title><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Montserrat',Arial,sans-serif;background:#f5f7fa;color:#333}.container{max-width:1200px;margin:0 auto;padding:30px}.header{text-align:center;margin-bottom:40px}.header h1{font-size:2.5em;color:#1a1a1a;margin-bottom:10px}.header p{font-size:1.1em;color:#666}.controls{background:white;padding:30px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);margin-bottom:40px}.control-group{margin-bottom:20px}.control-group label{display:block;font-weight:600;margin-bottom:8px;color:#333}textarea{width:100%;min-height:150px;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-family:'Montserrat';font-size:1em;resize:vertical;transition:border-color 0.3s}textarea:focus{outline:none;border-color:#195385}.input-row{display:flex;gap:20px;align-items:center;flex-wrap:wrap}.input-row input[type='file'],.input-row input[type='color']{padding:8px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em}.input-row input[type='color']{width:80px;height:50px;cursor:pointer;border:none}.color-label{display:flex;align-items:center;gap:10px}.button-group{display:flex;gap:15px;flex-wrap:wrap;margin-top:20px}button{padding:12px 24px;font-size:1em;font-weight:600;border:none;border-radius:8px;cursor:pointer;transition:all 0.3s;font-family:'Montserrat',Arial}.btn-primary{background:#195385;color:white}.btn-primary:hover{background:#0d2e52;transform:translateY(-2px);box-shadow:0 4px 12px rgba(25,83,133,0.3)}.btn-download{background:#2ecc71;color:white}.btn-download:hover{background:#27ae60;transform:translateY(-2px);box-shadow:0 4px 12px rgba(46,204,113,0.3)}.btn-download:disabled{background:#bdc3c7;cursor:not-allowed;transform:none}.preview-section{margin-top:40px}.preview-section h2{font-size:1.8em;margin-bottom:20px;color:#1a1a1a}.slides-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px}.slide-preview{position:relative;aspect-ratio:16/9;border-radius:12px;overflow:hidden;box-shadow:0 4px 15px rgba(0,0,0,0.15);display:flex;align-items:center;justify-content:center;padding:30px;color:white;text-align:center;transition:transform 0.3s}.slide-preview:hover{transform:translateY(-5px)}.slide-preview img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;opacity:0.7;z-index:1}.slide-text{position:relative;z-index:2;background:rgba(0,0,0,0.5);padding:20px;border-radius:8px;font-size:1.1em;line-height:1.6;font-weight:600}.slide-number{position:absolute;top:15px;right:15px;background:rgba(0,0,0,0.6);padding:8px 12px;border-radius:6px;font-size:0.9em;z-index:3}.alert{padding:15px;border-radius:8px;margin-bottom:20px;border:1px solid}.alert.error{background:#f8d7da;color:#721c24;border-color:#f5c6cb}.alert.success{background:#d4edda;color:#155724;border-color:#c3e6cb}.alert.info{background:#d1ecf1;color:#0c5460;border-color:#bee5eb}</style></head><body><div class="container"><div class="header"><h1>üé® Generatore Presentazioni</h1><p>Trasforma il tuo testo in PowerPoint o PDF</p></div><div class="controls"><div class="control-group"><label>üìù Testo da convertire</label><textarea id="inputText" placeholder="Incolla qui il tuo testo..."></textarea></div><div class="input-row"><div><label>üìÑ Carica file .txt</label><input type="file" id="fileInput" accept=".txt"></div><div class="color-label"><label for="colorPicker">üé® Colore Background</label><input type="color" id="colorPicker" value="#195385"></div></div><div class="button-group"><button class="btn-primary" onclick="generatePresentation()">‚ú® Genera</button><button class="btn-download" id="downloadPPTX" onclick="downloadPPTX()" disabled>üì• PPTX</button><button class="btn-download" id="downloadPDF" onclick="downloadPDF()" disabled>üì• PDF</button></div></div><div id="messageContainer"></div><div id="previewContainer"></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.10.0/pptxgen.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script><script>let slidesData=[];let currentBgColor='#195385';function showAlert(msg,type='info'){const c=document.getElementById('messageContainer');const div=document.createElement('div');div.className='alert '+type;div.textContent=msg;c.innerHTML='';c.appendChild(div);if(type!=='error'){setTimeout(()=>{c.innerHTML=''},5000)}}document.getElementById('colorPicker').addEventListener('change',(e)=>{currentBgColor=e.target.value});document.getElementById('fileInput').addEventListener('change',(e)=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=(ev)=>{document.getElementById('inputText').value=ev.target.result};r.readAsText(f)});function getTextColor(bg){const h=bg.substring(1);const r=parseInt(h.substr(0,2),16);const g=parseInt(h.substr(2,2),16);const b=parseInt(h.substr(4,2),16);return(0.299*r+0.587*g+0.114*b)/255>0.5?'#000000':'#FFFFFF'}function splitText(txt,ws=60){let words=txt.replace(/\.\s+/g,'.\n\n').split(/\s+/).filter(w=>w.length>0);let slides=[];for(let i=0;i<words.length;i+=ws){let c=words.slice(i,i+ws).join(' ');if(c.trim())slides.push(c.trim())}return slides.length>0?slides:[txt]}async function getImg(q){try{const url=`https://api.unsplash.com/photos/random?query=${encodeURIComponent(q.split(' ').slice(0,3).join(' '))}&orientation=landscape&w=1280&h=720&client_id=iCz1ZHZJPVJNqHvYrpW8qqXHDNZ_3lkQQ02VzMPraBY`;const res=await fetch(url);if(!res.ok)return null;const d=await res.json();return d.urls?.regular||null}catch(e){return null}}async function generatePresentation(){const txt=document.getElementById('inputText').value.trim();if(!txt){showAlert('‚ö†Ô∏è Per favore inserisci del testo!','error');return}currentBgColor=document.getElementById('colorPicker').value;slidesData=[];try{const slides=splitText(txt,60);for(let i=0;i<slides.length;i++){const st=slides[i];const img=await getImg(st);slidesData.push({text:st,image:img,bgColor:currentBgColor})}updatePreview();showAlert(`‚úÖ Presentazione generata con ${slidesData.length} slide!`,'success');document.getElementById('downloadPPTX').disabled=false;document.getElementById('downloadPDF').disabled=false}catch(e){showAlert('‚ùå Errore: '+e.message,'error');console.error(e)}}function updatePreview(){const c=document.getElementById('previewContainer');if(slidesData.length===0){c.innerHTML='';return}let h='<div class="preview-section"><h2>üìä Preview Slide</h2><div class="slides-container">';slidesData.forEach((s,idx)=>{const tc=getTextColor(s.bgColor);h+=`<div class="slide-preview" id="slide-${idx}" style="background-color:${s.bgColor};"> ${s.image?`<img src="${s.image}" alt="S${idx+1}" style="display:block;">`:''} <div style="color:${tc};" class="slide-text">${s.text}</div> <div class="slide-number" style="color:${tc};">Slide ${idx+1}</div> </div>`});h+='</div></div>';c.innerHTML=h}function downloadPPTX(){if(slidesData.length===0){showAlert('‚ùå Genera prima le slide!','error');return}try{const PptxGenJS=window.PptxGenJS;if(!PptxGenJS){showAlert('‚ùå Libreria PptxGenJS non caricata','error');return}let prs=new PptxGenJS();slidesData.forEach((s,idx)=>{let sld=prs.addSlide();sld.background={fill:s.bgColor};if(s.image){try{sld.addImage({path:s.image,x:0.3,y:0.3,w:8.5,h:4.2})}catch(e){console.warn('Errore caricamento immagine')}}const tc=getTextColor(s.bgColor);sld.addText(s.text,{fontFace:'Montserrat',color:tc,x:0.5,y:4.8,w:9,h:1.5,fontSize:18,align:'center',bold:true})});prs.writeFile({fileName:'presentazione.pptx'});showAlert('‚úÖ File PPTX scaricato con successo!','success')}catch(e){showAlert('‚ùå Errore nel download PPTX: '+e.message,'error');console.error(e)}}async function downloadPDF(){if(slidesData.length===0){showAlert('‚ùå Genera prima le slide!','error');return}try{const jsPDF=window.jsPDF.jsPDF;const html2canvas=window.html2canvas;if(!jsPDF||!html2canvas){showAlert('‚ùå Librerie non caricate','error');return}let pdf=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'});for(let i=0;i<slidesData.length;i++){const el=document.getElementById(`slide-${i}`);if(el){const c=await html2canvas(el,{scale:2,backgroundColor:slidesData[i].bgColor});const d=c.toDataURL('image/png');if(i>0)pdf.addPage();pdf.addImage(d,'PNG',10,10,190,110)}}pdf.save('presentazione.pdf');showAlert('‚úÖ File PDF scaricato con successo!','success')}catch(e){showAlert('‚ùå Errore nel download PDF: '+e.message,'error');console.error(e)}}<script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgen/3.12.0/pptxgen.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script></script></body></html>
